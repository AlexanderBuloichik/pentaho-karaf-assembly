<!--
  ~ This program is free software; you can redistribute it and/or modify it under the
  ~ terms of the GNU Lesser General Public License, version 2.1 as published by the Free Software
  ~ Foundation.
  ~
  ~ You should have received a copy of the GNU Lesser General Public License along with this
  ~ program; if not, you can obtain a copy at http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html
  ~ or from the Free Software Foundation, Inc.,
  ~ 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
  ~
  ~ This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  ~ See the GNU Lesser General Public License for more details.
  ~
  ~ Copyright 2014 Pentaho Corporation. All rights reserved.
  -->

<features xmlns="http://karaf.apache.org/xmlns/features/v1.3.0" name="pentaho-server">

  <!-- Overriding the default http feature -->
  <feature name="http" description="Implementation of the OSGi HTTP service" version="4.7.5">
    <feature version="3.1.2" prerequisite="true">cxf-core</feature>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-transports-http/3.1.2</bundle>
    <bundle>mvn:org.apache.felix/org.apache.felix.http.bridge/2.3.2</bundle>
  </feature>


  <feature name="http-whiteboard" version="4.10.0" description="Provide HTTP Whiteboard pattern support">
    <feature version="4.7.5">http</feature>
    <bundle start-level="30">mvn:org.apache.felix/org.apache.felix.http.whiteboard/2.3.2</bundle>
    <bundle start-level="30">mvn:org.ops4j.pax.web/pax-web-api/4.2.0</bundle>
    <bundle start-level="30">mvn:org.ops4j.pax.web/pax-web-extender-whiteboard/4.2.0</bundle>
  </feature>

  <!--
    <feature name="pax-http-whiteboard" description="Provide HTTP Whiteboard pattern support" version="3.1.4">
        <bundle start-level="30">mvn:org.ops4j.pax.web/pax-web-extender-whiteboard/3.1.4</bundle>
    </feature> -->

  <feature name="war" version="4.3.0" description="Turn Karaf as a full WebContainer">
    <feature>http</feature>
  </feature>


  <feature name="cxf-jaxws" version="3.7.5">
    <feature version="3.1.2">cxf-wsdl</feature>
    <feature version="3.1.2">cxf-databinding-jaxb</feature>
    <feature version="3.1.2">cxf-bindings-soap</feature>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-transports-http/3.1.2</bundle>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-frontend-simple/3.1.2</bundle>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-frontend-jaxws/3.1.2</bundle>
  </feature>
  <feature name="cxf-jaxrs" version="3.7.5">
    <feature version="3.1.2">cxf-core</feature>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-transports-http/3.1.2</bundle>
    <bundle start-level="30" dependency="true">mvn:org.codehaus.jettison/jettison/1.3.7</bundle>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-rs-extension-providers/3.1.2</bundle>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-rs-extension-search/3.1.2</bundle>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-rs-service-description/3.1.2</bundle>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-frontend-jaxrs/3.1.2</bundle>
    <bundle start-level="40">mvn:org.apache.cxf/cxf-rt-rs-client/3.1.2</bundle>
  </feature>

  <feature name="cxf" version="3.7.5">
    <feature version="3.1.2">cxf-core</feature>
    <feature version="3.7.5">cxf-jaxws</feature>
    <feature version="3.7.5">cxf-jaxrs</feature>
    <feature version="3.1.2">cxf-databinding-jaxb</feature>
    <feature version="3.1.2">cxf-databinding-aegis</feature>
    <feature version="3.1.2">cxf-databinding-xmlbeans</feature>
    <feature version="3.1.2">cxf-bindings-corba</feature>
    <feature version="3.1.2">cxf-bindings-coloc</feature>
    <feature version="3.1.2">cxf-bindings-object</feature>
    <feature version="3.1.2">cxf-xjc-runtime</feature>
    <feature version="3.1.2">cxf-ws-security</feature>
    <feature version="3.1.2">cxf-ws-rm</feature>
    <!-- <feature version="3.1.2">cxf-ws-mex</feature> -->
    <feature version="3.1.2">cxf-javascript</feature>
    <!-- <feature version="3.1.2">cxf-frontend-javascript</feature> -->
    <!-- <feature version="3.1.2">cxf-features-clustering</feature> -->
    <!-- <feature version="3.1.2">cxf-features-metrics</feature> -->
    <!-- <feature version="3.1.2">cxf-features-throttling</feature> -->
    <!-- <feature version="3.1.2">cxf-features-logging</feature> -->

    <!-- tools really aren't needed in OSGi by default
    <feature version="3.1.2">cxf-tools</feature>
    -->
    <!-- need msv
    <bundle>mvn:org.apache.cxf/cxf-wstx-msv-validation/3.1.2</bundle-->
    <!-- need sdo deps
    <bundle>mvn:org.apache.cxf/cxf-rt-databinding-sdo/3.1.2</bundle-->
  </feature>

  <feature name="spring-security" description="Spring Security 3.1.x support" version="3.1.4.PENTAHO">
    <feature prerequisite="false" dependency="false">war</feature>
    <feature version="[3,4)" prerequisite="false" dependency="false">spring-web</feature>
    <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.aspectj/1.7.4_1</bundle>
    <bundle start-level="30">mvn:org.springframework.security/spring-security-core/3.1.4.RELEASE</bundle>
    <bundle start-level="30">mvn:org.springframework.security/spring-security-config/3.1.4.RELEASE</bundle>
    <bundle start-level="30">mvn:org.springframework.security/spring-security-acl/3.1.4.RELEASE</bundle>
  </feature>

  <feature name="pentaho-server" version="1.0">
    <feature prerequisite="true">pentaho-base</feature>
    <feature prerequisite="true">pentaho-client</feature>
    <feature prerequisite="true" version="4.10.0">http-whiteboard</feature>

    <feature prerequisite="true" version="[4,4.1.5)">spring</feature>
    <!-- <feature prerequisite="true" version="3.1.4.PENTAHO">spring-security</feature> -->

    <bundle>mvn:pentaho/pentaho-server-bundle/6.0-SNAPSHOT</bundle>
    <bundle>mvn:pentaho/pentaho-requirejs-osgi-manager/6.0-SNAPSHOT</bundle>
    <bundle>blueprint:mvn:pentaho/pentaho-blueprint-activators/6.0-SNAPSHOT/xml/server</bundle>
    <bundle>blueprint:mvn:pentaho/pentaho-blueprint-activators/6.0-SNAPSHOT/xml/proxy-watcher</bundle>
    <bundle>mvn:pentaho/pentaho-angular-bundle/6.0-SNAPSHOT</bundle>
    <!-- <bundle>mvn:org.apache.felix/org.apache.felix.http.api/3.0.0</bundle> -->
    <!-- <bundle>mvn:org.apache.felix/org.apache.felix.http.bridge/2.3.2</bundle> -->

    <bundle start-level="20">blueprint:mvn:pentaho/pentaho-blueprint-activators/6.0-SNAPSHOT/xml/proxy-watcher</bundle>
    <!-- <bundle start-level="20">mvn:pentaho/pentaho-ss4-proxies/6.0-SNAPSHOT</bundle> -->
    <!-- <bundle start-level="20">mvn:pentaho/pentaho-ss2-proxies/6.0-SNAPSHOT</bundle> -->
    <!-- <bundle start-level="50">mvn:pentaho/pentaho-proxy-spring4/6.0-SNAPSHOT</bundle> -->

  </feature>

</features>
